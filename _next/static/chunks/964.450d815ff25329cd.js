(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[340,964],{1051:(e,t,r)=>{"use strict";r.r(t),r.d(t,{LG_COL:()=>y,XS_COL:()=>j,default:()=>C,getUnlockedComics:()=>b,unlockComic:()=>N,unlockComics:()=>w});var s=r(4848),i=r(6540),a=r(848),c=r(6871),n=r(1849),o=r(9753),l=r.n(o),d=r(6715),m=r(1106),h=r.n(m),p=r(3914),_=r(6188),u=r(5606);let g="1"===u.env.NEXT_PUBLIC_COMICS_UNLOCK_ALL,x="1"===u.env.NEXT_PUBLIC_ARCHIVE_COMICS_COUNT,f="1"===u.env.NEXT_PUBLIC_ARCHIVE_COMMENT_ICONS,j=12,y=8;function v(e){return`comic-${e.id}-unlocked`}function b(e){return e.map(e=>{let t=v(e);try{return"1"===localStorage.getItem(t)}catch(e){return console.error(e),!0}})}function N(e){try{localStorage.setItem(v(e),"1")}catch(e){console.error(e)}}function w(e){e.forEach(e=>N(e))}class A extends i.Component{static propTypes;constructor(e){super(e),this.state={input:""},this.onKeyUp=this.onKeyUp.bind(this),this.onTimeout=this.onTimeout.bind(this)}componentDidMount(){document.addEventListener("keyup",this.onKeyUp)}componentWillUnmount(){document.removeEventListener("keyup",this.onKeyUp),void 0!==this.state.timeoutId&&clearTimeout(this.state.timeoutId)}onKeyUp(e){void 0!==this.state.timeoutId&&clearTimeout(this.state.timeoutId);let t=this.state.input+e.code;t.includes("ArrowUpArrowUpArrowDownArrowDownArrowLeftArrowRightArrowLeftArrowRight")?(w(this.props.comics),alert("Vous avez d\xe9bloqu\xe9 tous les comics !"),this.onTimeout()):this.setState({input:t,timeoutId:window.setTimeout(this.onTimeout,500)})}onTimeout(){this.setState({input:""})}renderCategories(e){let t=t=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:l().icon,style:{backgroundImage:`url("${t.category.src}")`}}),(0,s.jsxs)("span",{className:l().title,children:[t.category.title,x?(0,s.jsx)("span",{children:`(${e.getCount(t)})`}):(0,s.jsx)(s.Fragment,{}),f&&this.props.comics.filter(e=>e.categoryIds.includes(t.category.id)).every(e=>""!==e.commentary)?(0,s.jsx)("span",{style:{marginLeft:"0.5em"},children:(0,s.jsx)(i.Suspense,{fallback:(0,s.jsx)(s.Fragment,{}),children:(0,s.jsx)(p.g,{className:l().commentary_icon,icon:_.Bep})})}):(0,s.jsx)(s.Fragment,{})]})]});return(0,s.jsx)("ul",{className:l().filters_list,children:e.categories.map(r=>(0,s.jsx)("li",{className:[l().item,e.isSelected(r)?l().selected:"",e.isDisabled(r)?l().disabled:""].join(" "),children:e.isDisabled(r)?(0,s.jsx)("div",{className:l().item_wrapper,children:t(r)}):(0,s.jsx)(h(),{className:l().item_wrapper,href:e.getHref(r),children:t(r)})},r.category.id))})}renderSeries(e){return this.renderCategories({categories:e.series.map(e=>({category:e.metadata,seriesIds:[e.metadata.id]})),isSelected:e.isSelected,isDisabled:e.isDisabled,getCount:e.getCount,getHref:e.getHref})}renderComics(e){let t=b(e);return(0,s.jsx)("ul",{className:l().comics_list,children:e.map((e,r)=>(0,s.jsx)("li",{className:l().item,children:(0,s.jsxs)(h(),{className:l().link,href:e.href,children:[(0,s.jsx)("div",{className:[l().icon,l().locked].join(" "),style:{...g||t[r]?{backgroundImage:`url("${e.src}")`}:{},aspectRatio:`${e.width}/${e.height}`},children:g||t[r]?(0,s.jsx)(s.Fragment,{}):(0,s.jsx)(i.Suspense,{fallback:(0,s.jsx)(s.Fragment,{}),children:(0,s.jsx)(p.g,{className:l().lock_icon,icon:_.DW4})})}),(0,s.jsx)("span",{className:l().title_wrapper,children:(0,s.jsxs)("span",{className:l().title,children:[g||t[r]?e.title:"???",f&&""!==e.commentary?(0,s.jsx)("span",{style:{marginLeft:"0.5em"},children:(0,s.jsx)(i.Suspense,{fallback:(0,s.jsx)(s.Fragment,{}),children:(0,s.jsx)(p.g,{className:l().commentary_icon,icon:_.Bep})})}):(0,s.jsx)(s.Fragment,{})]})})]})},e.id))})}renderPages(e){return(0,s.jsx)("ul",{className:l().pages_list,children:[...Array(e.numPages).keys()].map(e=>e+1).map(t=>(0,s.jsx)("li",{className:[l().page_item,e.currentPage===t?l().selected:""].join(" "),children:(0,s.jsx)(h(),{href:e.getHref(t),children:t})},t.toString()))})}render(){let{className:e,router:t}=this.props,{query:r}=t,i=this.props.series.find(e=>e.metadata.id===this.props.currentSeriesId),o=i?.categories?.find(e=>e.id===this.props.currentCategoryId),d=Number(r.page);Number.isNaN(d)&&(d=1);let m=this.props.comics.filter(e=>void 0===o||e.categoryIds.includes(o.id)),h=Math.max(Math.ceil(m.length/15),1);return m=m.slice((d-1)*15,15*d),(0,s.jsxs)(a.A,{className:[e||"",l().archive,"external_container"].join(" "),children:[(0,s.jsx)(c.A,{className:"justify-content-center",children:(0,s.jsxs)(n.A,{className:l().filters_col,xs:j,lg:y,children:[this.renderSeries({series:this.props.series,isSelected:e=>{let{category:t}=e;return t.id===i?.metadata?.id},isDisabled:()=>!1,getCount:()=>this.props.comics.length,getHref:e=>{let{category:t}=e;return`/archive${t.id===i?.metadata?.id?"":`/${t.id}`}`}}),...Object.values(Object.fromEntries(function(e,t){let r=new Map;return e.forEach(e=>{let s=t(e),i=r.get(s);i?i.push(e):r.set(s,[e])}),r}(Object.values(this.props.series.reduce((e,t)=>(t.categories.forEach(r=>{void 0===e[r.id]&&(e[r.id]={category:r,seriesIds:[]}),e[r.id].seriesIds.push(t.metadata.id)}),e),{})),e=>{let{category:t}=e;return t.row}))).map(e=>this.renderCategories({categories:e,isSelected:e=>{let{category:t}=e;return t.id===o?.id},isDisabled:e=>{let{seriesIds:t}=e;return void 0!==i&&!t.includes(i.metadata.id)},getCount:e=>{let{category:t}=e;return this.props.comics.filter(e=>e.categoryIds.includes(t.id)).length},getHref:e=>`/archive/${i?.metadata?.id??e.seriesIds[0]}${e.category.id===o?.id?"":`/${e.category.id}`}`}))]})}),(0,s.jsx)(c.A,{className:"justify-content-center",children:(0,s.jsx)(n.A,{xs:j,lg:y,children:this.renderComics(m)})}),(0,s.jsx)(c.A,{className:"justify-content-center",children:(0,s.jsx)(n.A,{className:l().pages_col,xs:j,lg:y,children:this.renderPages({numPages:h,currentPage:d,getHref:e=>({pathname:`/archive${void 0===i?"":`/${i.metadata.id}${void 0===o?"":`/${o.id}`}`}`,query:{page:e.toString()}})})})})]})}}A.propTypes={};let C=(0,d.withRouter)(A)},5964:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var s=r(4848),i=r(6540),a=r(1340),c=r(6715);class n extends i.Component{static propTypes;constructor(e){super(e)}render(){return(0,s.jsx)(a.default,{comic:this.props.comic,first:this.props.first,previous:this.props.previous,next:this.props.next,last:this.props.last})}}n.propTypes={};let o=(0,c.withRouter)(n)},1340:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>y});var s=r(4848),i=r(6540),a=r(848),c=r(6871),n=r(1849),o=r(3888),l=r.n(o),d=r(3914),m=r(6188),h=r(4267),p=r(1051),_=r(9965),u=r.n(_),g=r(1106),x=r.n(g),f=r(6715);class j extends i.Component{static propTypes;constructor(e){super(e),this.onKeyUp=this.onKeyUp.bind(this)}componentDidMount(){document.addEventListener("keyup",this.onKeyUp)}componentWillUnmount(){document.removeEventListener("keyup",this.onKeyUp)}onKeyUp(e){if("ArrowLeft"===e.code){let{previous:e}=this.props;void 0!==e&&this.props.router.push(e.href)}else if("ArrowRight"===e.code){let{next:e}=this.props;void 0!==e&&this.props.router.push(e.href)}}render(){let{className:e,comic:t,first:r,previous:o,next:_,last:g}=this.props,f=[{icon:m.z04,label:"Aller au premier comic",href:r.href,enabled:r.id!=t.metadata.id},{icon:m.TH3,label:"Aller au comic pr\xe9c\xe9dent",href:o?.href??"",enabled:r.id!=t.metadata.id},{icon:m.Qte,label:"Aller aux archives",href:"/archive",enabled:!0},{icon:m.xNJ,label:"Aller \xe0 un comic al\xe9atoire",href:"/random",enabled:!0},{icon:m.vFJ,label:"Aller au comic suivant",href:_?.href??"",enabled:g.id!=t.metadata.id},{icon:m.x5B,label:"Aller au dernier comic",href:g.href,enabled:g.id!=t.metadata.id}];return(0,p.unlockComic)(t.metadata),(0,s.jsx)(a.A,{className:[e||"",l().reader,"external_container"].join(" "),children:(0,s.jsx)(c.A,{className:"justify-content-center",children:(0,s.jsx)(n.A,{className:"d-flex flex-column justify-content-center align-items-center",xs:p.XS_COL,lg:p.LG_COL,children:(0,s.jsxs)("article",{className:l().reader_wrapper,style:{width:`${t.metadata.width*t.metadata.scale}px`},children:[(0,s.jsx)("header",{children:(0,s.jsx)("h1",{className:l().title,children:t.metadata.title})}),(0,s.jsx)("div",{className:l().image_wrapper,style:{width:`${t.metadata.width*t.metadata.scale}px`},children:(0,s.jsx)(u(),{className:l().image,src:t.metadata.src,alt:`image de ${t.metadata.title.toLowerCase()}`,width:`${t.metadata.width}`,height:`${t.metadata.height}`,style:{aspectRatio:`${t.metadata.width}/${t.metadata.height}`},priority:!0,unoptimized:!0})}),(0,s.jsx)("div",{className:l().toolbar,children:f.map((e,t)=>(0,s.jsx)(x(),{className:e.enabled?l().toolbar_enabled:l().toolbar_disabled,href:e.href,"aria-label":e.label,"aria-disabled":e.enabled?"false":"true",children:(0,s.jsx)(i.Suspense,{fallback:(0,s.jsx)(s.Fragment,{}),children:(0,s.jsx)(d.g,{className:l().toolbar_icon,icon:e.icon})})},t.toString()))}),(0,s.jsxs)("section",{className:l().info,children:[(0,s.jsxs)("footer",{className:l().date,children:[(0,s.jsx)("div",{children:t.series.title}),new Date(t.metadata.date).toLocaleString()]}),(0,s.jsxs)("div",{className:[l().commentary,""===t.metadata.commentary?l().no_commentary:""].join(" "),children:[(0,s.jsx)("div",{className:l().commentary_icon_wrapper,children:(0,s.jsx)(i.Suspense,{fallback:(0,s.jsx)(s.Fragment,{}),children:(0,s.jsx)(d.g,{className:l().commentary_icon,icon:m.Bep})})}),(0,s.jsx)(h.o,{children:""!==t.metadata.commentary?t.metadata.commentary:"Aucun commentaire disponible"})]})]})]})})})})}}j.propTypes={};let y=(0,f.withRouter)(j)},9753:e=>{e.exports={archive:"Archive_archive__cbfaC",selected:"Archive_selected__G04vY",icon:"Archive_icon__9dnQO",item:"Archive_item__26pu_",disabled:"Archive_disabled__KeEJf",filters_col:"Archive_filters_col__YqrT_",filters_list:"Archive_filters_list__7G4QR",item_wrapper:"Archive_item_wrapper__djda_",title:"Archive_title__OSZlL",comics_list:"Archive_comics_list__2M8Xx",title_wrapper:"Archive_title_wrapper__LOt2f",locked:"Archive_locked__1LcGT",lock_icon:"Archive_lock_icon__pe1zg",pages_col:"Archive_pages_col__Xm2hR",pages_list:"Archive_pages_list__rWv1H"}},3888:e=>{e.exports={reader:"Reader_reader__EgSBz",reader_wrapper:"Reader_reader_wrapper__K_Aq_",image_wrapper:"Reader_image_wrapper__KlZez",title:"Reader_title__TvQk7",image:"Reader_image__Nseb0",toolbar:"Reader_toolbar__AXumq",toolbar_icon:"Reader_toolbar_icon__u1Ywl",toolbar_disabled:"Reader_toolbar_disabled__0htMS",info:"Reader_info__VfXOY",date:"Reader_date__PJmve",commentary:"Reader_commentary__l2xmF",no_commentary:"Reader_no_commentary__Yi6oP",commentary_icon_wrapper:"Reader_commentary_icon_wrapper__6M3Vf",commentary_icon:"Reader_commentary_icon__TT32_"}}}]);