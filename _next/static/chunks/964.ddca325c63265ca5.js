(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[340,964],{1051:(e,t,r)=>{"use strict";r.r(t),r.d(t,{LG_COL:()=>w,XS_COL:()=>N,default:()=>L,getUnlockedComics:()=>C,unlockComic:()=>S,unlockComics:()=>k});var s,i=r(467),a=r(1893),c=r(5456),n=r(4848),o=r(6540),l=r(848),d=r(6871),m=r(1849),h=r(9753),p=r.n(h),_=r(6715),u=r(1106),g=r.n(u),x=r(3914),f=r(6188),j=r(5606);let v="1"===j.env.NEXT_PUBLIC_COMICS_UNLOCK_ALL,y="1"===j.env.NEXT_PUBLIC_ARCHIVE_COMICS_COUNT,b="1"===j.env.NEXT_PUBLIC_ARCHIVE_COMMENT_ICONS,N=12,w=8;function A(e){return"comic-".concat(e.id,"-unlocked")}function C(e){return e.map(e=>{let t=A(e);try{return"1"===localStorage.getItem(t)}catch(e){return console.error(e),!0}})}function S(e){try{localStorage.setItem(A(e),"1")}catch(e){console.error(e)}}function k(e){e.forEach(e=>S(e))}class I extends(s=o.Component){componentDidMount(){document.addEventListener("keyup",this.onKeyUp)}componentWillUnmount(){document.removeEventListener("keyup",this.onKeyUp),void 0!==this.state.timeoutId&&clearTimeout(this.state.timeoutId)}onKeyUp(e){void 0!==this.state.timeoutId&&clearTimeout(this.state.timeoutId);let t=this.state.input+e.code;t.includes("ArrowUpArrowUpArrowDownArrowDownArrowLeftArrowRightArrowLeftArrowRight")?(k(this.props.comics),alert("Vous avez d\xe9bloqu\xe9 tous les comics !"),this.onTimeout()):this.setState({input:t,timeoutId:window.setTimeout(this.onTimeout,500)})}onTimeout(){this.setState({input:""})}renderCategories(e){let t=t=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:p().icon,style:{backgroundImage:'url("'.concat(t.category.src,'")')}}),(0,n.jsxs)("span",{className:p().title,children:[t.category.title,y?(0,n.jsx)("span",{children:"(".concat(e.getCount(t),")")}):(0,n.jsx)(n.Fragment,{}),b&&this.props.comics.filter(e=>e.categoryIds.includes(t.category.id)).every(e=>""!==e.commentary)?(0,n.jsx)("span",{style:{marginLeft:"0.5em"},children:(0,n.jsx)(o.Suspense,{fallback:(0,n.jsx)(n.Fragment,{}),children:(0,n.jsx)(x.g,{className:p().commentary_icon,icon:f.Bep})})}):(0,n.jsx)(n.Fragment,{})]})]});return(0,n.jsx)("ul",{className:p().filters_list,children:e.categories.map(r=>(0,n.jsx)("li",{className:[p().item,e.isSelected(r)?p().selected:"",e.isDisabled(r)?p().disabled:""].join(" "),children:e.isDisabled(r)?(0,n.jsx)("div",{className:p().item_wrapper,children:t(r)}):(0,n.jsx)(g(),{className:p().item_wrapper,href:e.getHref(r),children:t(r)})},r.category.id))})}renderSeries(e){return this.renderCategories({categories:e.series.map(e=>({category:e.metadata,seriesIds:[e.metadata.id]})),isSelected:e.isSelected,isDisabled:e.isDisabled,getCount:e.getCount,getHref:e.getHref})}renderComics(e){let t=C(e);return(0,n.jsx)("ul",{className:p().comics_list,children:e.map((e,r)=>(0,n.jsx)("li",{className:p().item,children:(0,n.jsxs)(g(),{className:p().link,href:e.href,children:[(0,n.jsx)("div",{className:[p().icon,p().locked].join(" "),style:(0,c._)((0,a._)({},v||t[r]?{backgroundImage:'url("'.concat(e.src,'")')}:{}),{aspectRatio:"".concat(e.width,"/").concat(e.height)}),children:v||t[r]?(0,n.jsx)(n.Fragment,{}):(0,n.jsx)(o.Suspense,{fallback:(0,n.jsx)(n.Fragment,{}),children:(0,n.jsx)(x.g,{className:p().lock_icon,icon:f.DW4})})}),(0,n.jsx)("span",{className:p().title_wrapper,children:(0,n.jsxs)("span",{className:p().title,children:[v||t[r]?e.title:"???",b&&""!==e.commentary?(0,n.jsx)("span",{style:{marginLeft:"0.5em"},children:(0,n.jsx)(o.Suspense,{fallback:(0,n.jsx)(n.Fragment,{}),children:(0,n.jsx)(x.g,{className:p().commentary_icon,icon:f.Bep})})}):(0,n.jsx)(n.Fragment,{})]})})]})},e.id))})}renderPages(e){return(0,n.jsx)("ul",{className:p().pages_list,children:[...Array(e.numPages).keys()].map(e=>e+1).map(t=>(0,n.jsx)("li",{className:[p().page_item,e.currentPage===t?p().selected:""].join(" "),children:(0,n.jsx)(g(),{href:e.getHref(t),children:t})},t.toString()))})}render(){var e,t;let{className:r,router:s,currentCategoryId:i}=this.props,{query:a}=s,c=this.props.currentSeriesId?this.props.series.find(e=>e.metadata.id===this.props.currentSeriesId):void 0,o=null!==(t=this.props.currentSeriesId)&&void 0!==t?t:"all",h=null==c?void 0:null===(e=c.categories)||void 0===e?void 0:e.find(e=>e.id===i),_=Number(a.page);Number.isNaN(_)&&(_=1);let u=this.props.comics.filter(e=>void 0===h||e.categoryIds.includes(h.id)),g=Math.max(Math.ceil(u.length/15),1);return u=u.slice((_-1)*15,15*_),(0,n.jsxs)(l.A,{className:[r||"",p().archive,"external_container"].join(" "),children:[(0,n.jsx)(d.A,{className:"justify-content-center",children:(0,n.jsxs)(m.A,{className:p().filters_col,xs:N,lg:w,children:[this.renderSeries({series:this.props.series,isSelected:e=>{let{category:t}=e;return t.id===o},isDisabled:()=>!1,getCount:()=>this.props.comics.length,getHref:e=>{let{category:t}=e;return"/archive".concat(t.id===o?"":"/".concat(t.id))}}),...Object.values(Object.fromEntries(function(e,t){let r=new Map;return e.forEach(e=>{let s=t(e),i=r.get(s);i?i.push(e):r.set(s,[e])}),r}(Object.values(this.props.series.reduce((e,t)=>(t.categories.forEach(r=>{void 0===e[r.id]&&(e[r.id]={category:r,seriesIds:[]}),e[r.id].seriesIds.push(t.metadata.id)}),e),{})),e=>{let{category:t}=e;return t.row}))).map(e=>this.renderCategories({categories:e,isSelected:e=>{let{category:t}=e;return t.id===i},isDisabled:e=>{let{seriesIds:t}=e;return void 0!==c&&!t.includes(o)},getCount:e=>{let{category:t}=e;return this.props.comics.filter(e=>e.categoryIds.includes(t.id)).length},getHref:e=>"/archive".concat(e.category.id===i?void 0!==o&&"all"!==o?"/".concat(o):"":"/".concat(o,"/").concat(e.category.id))}))]})}),(0,n.jsx)(d.A,{className:"justify-content-center",children:(0,n.jsx)(m.A,{xs:N,lg:w,children:this.renderComics(u)})}),(0,n.jsx)(d.A,{className:"justify-content-center",children:(0,n.jsx)(m.A,{className:p().pages_col,xs:N,lg:w,children:this.renderPages({numPages:g,currentPage:_,getHref:e=>({pathname:"/archive".concat(this.props.currentSeriesId?"/".concat(this.props.currentSeriesId).concat(i?"/".concat(i):""):""),query:{page:e.toString()}})})})})]})}constructor(e){super(e),this.state={input:""},this.onKeyUp=this.onKeyUp.bind(this),this.onTimeout=this.onTimeout.bind(this)}}(0,i._)(I,"propTypes",void 0),I.propTypes={};let L=(0,_.withRouter)(I)},5964:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var s,i=r(467),a=r(4848),c=r(6540),n=r(1340),o=r(6715);class l extends(s=c.Component){render(){return(0,a.jsx)(n.default,{comic:this.props.comic,first:this.props.first,previous:this.props.previous,next:this.props.next,last:this.props.last})}constructor(e){super(e)}}(0,i._)(l,"propTypes",void 0),l.propTypes={};let d=(0,o.withRouter)(l)},1340:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b});var s,i=r(467),a=r(4848),c=r(6540),n=r(848),o=r(6871),l=r(1849),d=r(3888),m=r.n(d),h=r(3914),p=r(6188),_=r(4267),u=r(1051),g=r(9965),x=r.n(g),f=r(1106),j=r.n(f),v=r(6715);class y extends(s=c.Component){componentDidMount(){document.addEventListener("keyup",this.onKeyUp)}componentWillUnmount(){document.removeEventListener("keyup",this.onKeyUp)}onKeyUp(e){if("ArrowLeft"===e.code){let{previous:e}=this.props;void 0!==e&&this.props.router.push(e.href)}else if("ArrowRight"===e.code){let{next:e}=this.props;void 0!==e&&this.props.router.push(e.href)}}render(){var e,t;let{className:r,comic:s,first:i,previous:d,next:g,last:f}=this.props,v=[{icon:p.z04,label:"Aller au premier comic",href:i.href,enabled:i.id!=s.metadata.id},{icon:p.TH3,label:"Aller au comic pr\xe9c\xe9dent",href:null!==(e=null==d?void 0:d.href)&&void 0!==e?e:"",enabled:i.id!=s.metadata.id},{icon:p.Qte,label:"Aller aux archives",href:"/archive",enabled:!0},{icon:p.xNJ,label:"Aller \xe0 un comic al\xe9atoire",href:"/random",enabled:!0},{icon:p.vFJ,label:"Aller au comic suivant",href:null!==(t=null==g?void 0:g.href)&&void 0!==t?t:"",enabled:f.id!=s.metadata.id},{icon:p.x5B,label:"Aller au dernier comic",href:f.href,enabled:f.id!=s.metadata.id}];return(0,u.unlockComic)(s.metadata),(0,a.jsx)(n.A,{className:[r||"",m().reader,"external_container"].join(" "),children:(0,a.jsx)(o.A,{className:"justify-content-center",children:(0,a.jsx)(l.A,{className:"d-flex flex-column justify-content-center align-items-center",xs:u.XS_COL,lg:u.LG_COL,children:(0,a.jsxs)("article",{className:m().reader_wrapper,style:{width:"".concat(s.metadata.width*s.metadata.scale,"px")},children:[(0,a.jsx)("header",{children:(0,a.jsx)("h1",{className:m().title,children:s.metadata.title})}),(0,a.jsx)("div",{className:m().image_wrapper,style:{width:"".concat(s.metadata.width*s.metadata.scale,"px")},children:(0,a.jsx)(x(),{className:m().image,src:s.metadata.src,alt:"image de ".concat(s.metadata.title.toLowerCase()),width:"".concat(s.metadata.width),height:"".concat(s.metadata.height),style:{aspectRatio:"".concat(s.metadata.width,"/").concat(s.metadata.height)},priority:!0,unoptimized:!0})}),(0,a.jsx)("div",{className:m().toolbar,children:v.map((e,t)=>(0,a.jsx)(j(),{className:e.enabled?m().toolbar_enabled:m().toolbar_disabled,href:e.href,"aria-label":e.label,"aria-disabled":e.enabled?"false":"true",children:(0,a.jsx)(c.Suspense,{fallback:(0,a.jsx)(a.Fragment,{}),children:(0,a.jsx)(h.g,{className:m().toolbar_icon,icon:e.icon})})},t.toString()))}),(0,a.jsxs)("section",{className:m().info,children:[(0,a.jsxs)("footer",{className:m().date,children:[(0,a.jsx)("div",{children:s.series.title}),new Date(s.metadata.date).toLocaleString()]}),(0,a.jsxs)("div",{className:[m().commentary,""===s.metadata.commentary?m().no_commentary:""].join(" "),children:[(0,a.jsx)("div",{className:m().commentary_icon_wrapper,children:(0,a.jsx)(c.Suspense,{fallback:(0,a.jsx)(a.Fragment,{}),children:(0,a.jsx)(h.g,{className:m().commentary_icon,icon:p.Bep})})}),(0,a.jsx)(_.o,{children:""!==s.metadata.commentary?s.metadata.commentary:"Aucun commentaire disponible"})]})]})]})})})})}constructor(e){super(e),this.onKeyUp=this.onKeyUp.bind(this)}}(0,i._)(y,"propTypes",void 0),y.propTypes={};let b=(0,v.withRouter)(y)},9753:e=>{e.exports={archive:"Archive_archive__cbfaC",selected:"Archive_selected__G04vY",icon:"Archive_icon__9dnQO",item:"Archive_item__26pu_",disabled:"Archive_disabled__KeEJf",filters_col:"Archive_filters_col__YqrT_",filters_list:"Archive_filters_list__7G4QR",item_wrapper:"Archive_item_wrapper__djda_",title:"Archive_title__OSZlL",comics_list:"Archive_comics_list__2M8Xx",title_wrapper:"Archive_title_wrapper__LOt2f",locked:"Archive_locked__1LcGT",lock_icon:"Archive_lock_icon__pe1zg",pages_col:"Archive_pages_col__Xm2hR",pages_list:"Archive_pages_list__rWv1H"}},3888:e=>{e.exports={reader:"Reader_reader__EgSBz",reader_wrapper:"Reader_reader_wrapper__K_Aq_",image_wrapper:"Reader_image_wrapper__KlZez",title:"Reader_title__TvQk7",image:"Reader_image__Nseb0",toolbar:"Reader_toolbar__AXumq",toolbar_icon:"Reader_toolbar_icon__u1Ywl",toolbar_disabled:"Reader_toolbar_disabled__0htMS",info:"Reader_info__VfXOY",date:"Reader_date__PJmve",commentary:"Reader_commentary__l2xmF",no_commentary:"Reader_no_commentary__Yi6oP",commentary_icon_wrapper:"Reader_commentary_icon_wrapper__6M3Vf",commentary_icon:"Reader_commentary_icon__TT32_"}}}]);