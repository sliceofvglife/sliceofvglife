(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[340],{1051:(e,t,r)=>{"use strict";r.r(t),r.d(t,{LG_COL:()=>y,XS_COL:()=>j,default:()=>C,getUnlockedComics:()=>v,unlockComic:()=>N,unlockComics:()=>A});var s=r(4848),i=r(6540),a=r(848),c=r(6871),n=r(1849),l=r(9753),o=r.n(l),d=r(6715),m=r(1106),h=r.n(m),_=r(3914),p=r(6188),u=r(5606);let g="1"===u.env.NEXT_PUBLIC_COMICS_UNLOCK_ALL,x="1"===u.env.NEXT_PUBLIC_ARCHIVE_COMICS_COUNT,f="1"===u.env.NEXT_PUBLIC_ARCHIVE_COMMENT_ICONS,j=12,y=8;function b(e){return`comic-${e.id}-unlocked`}function v(e){return e.map(e=>{let t=b(e);try{return"1"===localStorage.getItem(t)}catch(e){return console.error(e),!0}})}function N(e){try{localStorage.setItem(b(e),"1")}catch(e){console.error(e)}}function A(e){e.forEach(e=>N(e))}class w extends i.Component{static propTypes;constructor(e){super(e),this.state={input:""},this.onKeyUp=this.onKeyUp.bind(this),this.onTimeout=this.onTimeout.bind(this)}componentDidMount(){document.addEventListener("keyup",this.onKeyUp)}componentWillUnmount(){document.removeEventListener("keyup",this.onKeyUp),void 0!==this.state.timeoutId&&clearTimeout(this.state.timeoutId)}onKeyUp(e){void 0!==this.state.timeoutId&&clearTimeout(this.state.timeoutId);let t=this.state.input+e.code;t.includes("ArrowUpArrowUpArrowDownArrowDownArrowLeftArrowRightArrowLeftArrowRight")?(A(this.props.comics),alert("Vous avez d\xe9bloqu\xe9 tous les comics !"),this.onTimeout()):this.setState({input:t,timeoutId:window.setTimeout(this.onTimeout,500)})}onTimeout(){this.setState({input:""})}renderCategories(e){let t=t=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:o().icon,style:{backgroundImage:`url("${t.category.src}")`}}),(0,s.jsxs)("span",{className:o().title,children:[t.category.title,x?(0,s.jsx)("span",{children:`(${e.getCount(t)})`}):(0,s.jsx)(s.Fragment,{}),f&&this.props.comics.filter(e=>e.categoryIds.includes(t.category.id)).every(e=>""!==e.commentary)?(0,s.jsx)("span",{style:{marginLeft:"0.5em"},children:(0,s.jsx)(i.Suspense,{fallback:(0,s.jsx)(s.Fragment,{}),children:(0,s.jsx)(_.g,{className:o().commentary_icon,icon:p.Bep})})}):(0,s.jsx)(s.Fragment,{})]})]});return(0,s.jsx)("ul",{className:o().filters_list,children:e.categories.map(r=>(0,s.jsx)("li",{className:[o().item,e.isSelected(r)?o().selected:"",e.isDisabled(r)?o().disabled:""].join(" "),children:e.isDisabled(r)?(0,s.jsx)("div",{className:o().item_wrapper,children:t(r)}):(0,s.jsx)(h(),{className:o().item_wrapper,href:e.getHref(r),children:t(r)})},r.category.id))})}renderSeries(e){return this.renderCategories({categories:e.series.map(e=>({category:e.metadata,seriesIds:[e.metadata.id]})),isSelected:e.isSelected,isDisabled:e.isDisabled,getCount:e.getCount,getHref:e.getHref})}renderComics(e){let t=v(e);return(0,s.jsx)("ul",{className:o().comics_list,children:e.map((e,r)=>(0,s.jsx)("li",{className:o().item,children:(0,s.jsxs)(h(),{className:o().link,href:e.href,children:[(0,s.jsx)("div",{className:[o().icon,o().locked].join(" "),style:{...g||t[r]?{backgroundImage:`url("${e.src}")`}:{},aspectRatio:`${e.width}/${e.height}`},children:g||t[r]?(0,s.jsx)(s.Fragment,{}):(0,s.jsx)(i.Suspense,{fallback:(0,s.jsx)(s.Fragment,{}),children:(0,s.jsx)(_.g,{className:o().lock_icon,icon:p.DW4})})}),(0,s.jsx)("span",{className:o().title_wrapper,children:(0,s.jsxs)("span",{className:o().title,children:[g||t[r]?e.title:"???",f&&""!==e.commentary?(0,s.jsx)("span",{style:{marginLeft:"0.5em"},children:(0,s.jsx)(i.Suspense,{fallback:(0,s.jsx)(s.Fragment,{}),children:(0,s.jsx)(_.g,{className:o().commentary_icon,icon:p.Bep})})}):(0,s.jsx)(s.Fragment,{})]})})]})},e.id))})}renderPages(e){return(0,s.jsx)("ul",{className:o().pages_list,children:[...Array(e.numPages).keys()].map(e=>e+1).map(t=>(0,s.jsx)("li",{className:[o().page_item,e.currentPage===t?o().selected:""].join(" "),children:(0,s.jsx)(h(),{href:e.getHref(t),children:t})},t.toString()))})}render(){let{className:e,router:t,currentCategoryId:r}=this.props,{query:i}=t,l=this.props.currentSeriesId?this.props.series.find(e=>e.metadata.id===this.props.currentSeriesId):void 0,d=this.props.currentSeriesId??"all",m=l?.categories?.find(e=>e.id===r),h=Number(i.page);Number.isNaN(h)&&(h=1);let _=this.props.comics.filter(e=>void 0===m||e.categoryIds.includes(m.id)),p=Math.max(Math.ceil(_.length/15),1);return _=_.slice((h-1)*15,15*h),(0,s.jsxs)(a.A,{className:[e||"",o().archive,"external_container"].join(" "),children:[(0,s.jsx)(c.A,{className:"justify-content-center",children:(0,s.jsxs)(n.A,{className:o().filters_col,xs:j,lg:y,children:[this.renderSeries({series:this.props.series,isSelected:e=>{let{category:t}=e;return t.id===d},isDisabled:()=>!1,getCount:()=>this.props.comics.length,getHref:e=>{let{category:t}=e;return`/archive${t.id===d?"":`/${t.id}`}`}}),...Object.values(Object.fromEntries(function(e,t){let r=new Map;return e.forEach(e=>{let s=t(e),i=r.get(s);i?i.push(e):r.set(s,[e])}),r}(Object.values(this.props.series.reduce((e,t)=>(t.categories.forEach(r=>{void 0===e[r.id]&&(e[r.id]={category:r,seriesIds:[]}),e[r.id].seriesIds.push(t.metadata.id)}),e),{})),e=>{let{category:t}=e;return t.row}))).map(e=>this.renderCategories({categories:e,isSelected:e=>{let{category:t}=e;return t.id===r},isDisabled:e=>{let{seriesIds:t}=e;return void 0!==l&&!t.includes(d)},getCount:e=>{let{category:t}=e;return this.props.comics.filter(e=>e.categoryIds.includes(t.id)).length},getHref:e=>`/archive/${e.category.id===r?void 0!==d&&"all"!==d?`/${d}`:"":`/${d}/${e.category.id}`}`}))]})}),(0,s.jsx)(c.A,{className:"justify-content-center",children:(0,s.jsx)(n.A,{xs:j,lg:y,children:this.renderComics(_)})}),(0,s.jsx)(c.A,{className:"justify-content-center",children:(0,s.jsx)(n.A,{className:o().pages_col,xs:j,lg:y,children:this.renderPages({numPages:p,currentPage:h,getHref:e=>({pathname:`/archive${this.props.currentSeriesId?`/${this.props.currentSeriesId}${r?`/${r}`:""}`:""}`,query:{page:e.toString()}})})})})]})}}w.propTypes={};let C=(0,d.withRouter)(w)},1340:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>y});var s=r(4848),i=r(6540),a=r(848),c=r(6871),n=r(1849),l=r(3888),o=r.n(l),d=r(3914),m=r(6188),h=r(4267),_=r(1051),p=r(9965),u=r.n(p),g=r(1106),x=r.n(g),f=r(6715);class j extends i.Component{static propTypes;constructor(e){super(e),this.onKeyUp=this.onKeyUp.bind(this)}componentDidMount(){document.addEventListener("keyup",this.onKeyUp)}componentWillUnmount(){document.removeEventListener("keyup",this.onKeyUp)}onKeyUp(e){if("ArrowLeft"===e.code){let{previous:e}=this.props;void 0!==e&&this.props.router.push(e.href)}else if("ArrowRight"===e.code){let{next:e}=this.props;void 0!==e&&this.props.router.push(e.href)}}render(){let{className:e,comic:t,first:r,previous:l,next:p,last:g}=this.props,f=[{icon:m.z04,label:"Aller au premier comic",href:r.href,enabled:r.id!=t.metadata.id},{icon:m.TH3,label:"Aller au comic pr\xe9c\xe9dent",href:l?.href??"",enabled:r.id!=t.metadata.id},{icon:m.Qte,label:"Aller aux archives",href:"/archive",enabled:!0},{icon:m.xNJ,label:"Aller \xe0 un comic al\xe9atoire",href:"/random",enabled:!0},{icon:m.vFJ,label:"Aller au comic suivant",href:p?.href??"",enabled:g.id!=t.metadata.id},{icon:m.x5B,label:"Aller au dernier comic",href:g.href,enabled:g.id!=t.metadata.id}];return(0,_.unlockComic)(t.metadata),(0,s.jsx)(a.A,{className:[e||"",o().reader,"external_container"].join(" "),children:(0,s.jsx)(c.A,{className:"justify-content-center",children:(0,s.jsx)(n.A,{className:"d-flex flex-column justify-content-center align-items-center",xs:_.XS_COL,lg:_.LG_COL,children:(0,s.jsxs)("article",{className:o().reader_wrapper,style:{width:`${t.metadata.width*t.metadata.scale}px`},children:[(0,s.jsx)("header",{children:(0,s.jsx)("h1",{className:o().title,children:t.metadata.title})}),(0,s.jsx)("div",{className:o().image_wrapper,style:{width:`${t.metadata.width*t.metadata.scale}px`},children:(0,s.jsx)(u(),{className:o().image,src:t.metadata.src,alt:`image de ${t.metadata.title.toLowerCase()}`,width:`${t.metadata.width}`,height:`${t.metadata.height}`,style:{aspectRatio:`${t.metadata.width}/${t.metadata.height}`},priority:!0,unoptimized:!0})}),(0,s.jsx)("div",{className:o().toolbar,children:f.map((e,t)=>(0,s.jsx)(x(),{className:e.enabled?o().toolbar_enabled:o().toolbar_disabled,href:e.href,"aria-label":e.label,"aria-disabled":e.enabled?"false":"true",children:(0,s.jsx)(i.Suspense,{fallback:(0,s.jsx)(s.Fragment,{}),children:(0,s.jsx)(d.g,{className:o().toolbar_icon,icon:e.icon})})},t.toString()))}),(0,s.jsxs)("section",{className:o().info,children:[(0,s.jsxs)("footer",{className:o().date,children:[(0,s.jsx)("div",{children:t.series.title}),new Date(t.metadata.date).toLocaleString()]}),(0,s.jsxs)("div",{className:[o().commentary,""===t.metadata.commentary?o().no_commentary:""].join(" "),children:[(0,s.jsx)("div",{className:o().commentary_icon_wrapper,children:(0,s.jsx)(i.Suspense,{fallback:(0,s.jsx)(s.Fragment,{}),children:(0,s.jsx)(d.g,{className:o().commentary_icon,icon:m.Bep})})}),(0,s.jsx)(h.o,{children:""!==t.metadata.commentary?t.metadata.commentary:"Aucun commentaire disponible"})]})]})]})})})})}}j.propTypes={};let y=(0,f.withRouter)(j)},9753:e=>{e.exports={archive:"Archive_archive__cbfaC",selected:"Archive_selected__G04vY",icon:"Archive_icon__9dnQO",item:"Archive_item__26pu_",disabled:"Archive_disabled__KeEJf",filters_col:"Archive_filters_col__YqrT_",filters_list:"Archive_filters_list__7G4QR",item_wrapper:"Archive_item_wrapper__djda_",title:"Archive_title__OSZlL",comics_list:"Archive_comics_list__2M8Xx",title_wrapper:"Archive_title_wrapper__LOt2f",locked:"Archive_locked__1LcGT",lock_icon:"Archive_lock_icon__pe1zg",pages_col:"Archive_pages_col__Xm2hR",pages_list:"Archive_pages_list__rWv1H"}},3888:e=>{e.exports={reader:"Reader_reader__EgSBz",reader_wrapper:"Reader_reader_wrapper__K_Aq_",image_wrapper:"Reader_image_wrapper__KlZez",title:"Reader_title__TvQk7",image:"Reader_image__Nseb0",toolbar:"Reader_toolbar__AXumq",toolbar_icon:"Reader_toolbar_icon__u1Ywl",toolbar_disabled:"Reader_toolbar_disabled__0htMS",info:"Reader_info__VfXOY",date:"Reader_date__PJmve",commentary:"Reader_commentary__l2xmF",no_commentary:"Reader_no_commentary__Yi6oP",commentary_icon_wrapper:"Reader_commentary_icon_wrapper__6M3Vf",commentary_icon:"Reader_commentary_icon__TT32_"}}}]);